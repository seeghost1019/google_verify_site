<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>114å¹´åº¦å˜‰æ¦®æ°¸çºŒç”Ÿæ´»è¡Œå‹•ææ¡ˆ - äº’å‹•æ±ºç­–ç³»çµ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f0fdf4; /* Light green background */
            color: #1a202c;
        }
        /* Chart Container Styling per requirements */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px; /* max-w-2xl equivalent ish */
            margin-left: auto;
            margin-right: auto;
            height: 400px; /* Base height */
            max-height: 500px;
        }
        @media (max-width: 640px) {
            .chart-container {
                height: 300px;
            }
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .active-tab {
            border-bottom: 2px solid #166534; /* green-800 */
            color: #166534;
            font-weight: 700;
        }
        .inactive-tab {
            color: #6b7280; /* gray-500 */
        }
        .hide {
            display: none;
        }
        .fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        /* Toast Notification */
        #toast-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 100;
        }
        .toast {
            background-color: #064e3b;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            margin-top: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            animation: slideIn 0.3s ease-out, fadeOut 0.5s ease-in 2.5s forwards;
        }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
    </style>
    <!-- Chosen Palette: Nature Green & Clean White (Minimalist, Calm, Supportive) -->
    <!-- Application Structure Plan: 
         1. Header: Context, Goal, and Voting Results Trigger.
         2. Strategic Analysis (Scatter Plot): A high-level view mapping all 16 proposals.
         3. Proposal Catalog (Grid): The 8 dimensions presented as cards.
         4. Detail View (Dynamic Section): Side-by-side comparison of Plan A/B with Voting Buttons.
         5. Results Modal: Bar chart showing top voted proposals.
    -->
    <!-- Visualization & Content Choices:
         - Scatter Plot (Chart.js): Compare Effort vs. Impact.
         - Voting System (JS + LocalStorage): Interaction: Click to vote. Goal: Decision making.
         - Results Bar Chart (Chart.js): Goal: Visualize consensus.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="bg-stone-50 text-stone-800">

    <!-- Navbar / Header -->
    <header class="bg-emerald-800 text-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4 flex flex-col md:flex-row justify-between items-center">
            <div class="mb-2 md:mb-0 text-center md:text-left">
                <h1 class="text-xl md:text-2xl font-bold">114å¹´åº¦æ°¸çºŒç”Ÿæ´»è¡Œå‹•ææ¡ˆ</h1>
                <p class="text-sm text-emerald-100">ææ¡ˆå–®ä½ï¼šå®¶é†«éƒ¨ ç¤¾å€å¥åº·ç‡Ÿé€ ä¸­å¿ƒ</p>
            </div>
            <nav class="flex gap-4 text-sm items-center">
                <button onclick="scrollToSection('strategy-section')" class="hover:text-emerald-200 transition">ç­–ç•¥åˆ†æ</button>
                <button onclick="scrollToSection('catalog-section')" class="hover:text-emerald-200 transition">å…«å¤§é¢å‘ç¸½è¦½</button>
                <button onclick="openResults()" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-full font-bold shadow-md transition transform hover:scale-105 flex items-center gap-2">
                    <span>ğŸ†</span> æŸ¥çœ‹ç¥¨é¸çµæœ
                </button>
            </nav>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8 space-y-12">

        <!-- Introduction Section -->
        <section class="max-w-4xl mx-auto text-center space-y-4">
            <h2 class="text-3xl font-bold text-emerald-900">æ°¸çºŒè¡Œå‹•ï¼Œå¾æˆ‘å€‘åšèµ·</h2>
            <p class="text-lg text-gray-600 leading-relaxed">
                æœ¬å¹³å°æ—¨åœ¨å”åŠ©ç¤¾å€å¥åº·ç‡Ÿé€ ä¸­å¿ƒåŒä»ï¼Œæ–¼ç§‘å®¤æœƒè­°ä¸­å¿«é€Ÿç€è¦½ã€åˆ†æä¸¦æ±ºç­–é©åˆæœ¬å–®ä½åŸ·è¡Œçš„æ°¸çºŒææ¡ˆã€‚
                æˆ‘å€‘å°‡å…«å¤§é¢å‘çš„è¡Œå‹•å®ˆå‰‡è½‰åŒ–ç‚º **16 å€‹å…·é«”åŸ·è¡Œæ–¹æ¡ˆ**ã€‚è«‹é€éä¸‹æ–¹çš„ç­–ç•¥åˆ†æåœ–èˆ‡è©³ç´°å…§å®¹ï¼Œæ‰¾å‡ºã€Œæ•ˆç›Šæœ€é«˜ã€è² æ“”æœ€å°ã€çš„æœ€ä½³è§£ã€‚
            </p>
        </section>

        <!-- Strategy Section: Scatter Plot -->
        <section id="strategy-section" class="bg-white rounded-2xl shadow-sm border border-stone-200 p-6">
            <div class="mb-6">
                <h3 class="text-2xl font-bold text-emerald-800 flex items-center gap-2">
                    <span>ğŸ“Š</span> ææ¡ˆç­–ç•¥åˆ†æçŸ©é™£
                </h3>
                <p class="text-gray-500 mt-2">
                    æ­¤åœ–è¡¨æ ¹æ“š**ã€ŒåŸ·è¡Œé›£æ˜“åº¦ã€**ï¼ˆXè»¸ï¼Œè¶Šå³è¶Šé›£ï¼‰èˆ‡**ã€Œé æœŸå½±éŸ¿åŠ›ã€**ï¼ˆYè»¸ï¼Œè¶Šé«˜è¶Šå¥½ï¼‰å°‡æ‰€æœ‰æ–¹æ¡ˆé€²è¡Œå®šä½ã€‚
                    <br><span class="text-sm font-medium text-emerald-600">é»æ“Šåœ–è¡¨ä¸­çš„åœ“é»ï¼Œå¯ç›´æ¥è·³è½‰è‡³è©²ææ¡ˆè©³æƒ…ã€‚</span>
                </p>
            </div>
            
            <div class="w-full flex justify-center">
                <div class="chart-container">
                    <canvas id="strategyChart"></canvas>
                </div>
            </div>
            
            <div class="mt-4 flex flex-wrap gap-4 justify-center text-sm text-gray-500">
                <div class="flex items-center gap-2"><span class="w-3 h-3 rounded-full bg-emerald-500"></span> æ–¹æ¡ˆ A (åˆ¶åº¦å»ºç«‹)</div>
                <div class="flex items-center gap-2"><span class="w-3 h-3 rounded-full bg-blue-500"></span> æ–¹æ¡ˆ B (å…·é«”è¡Œå‹•)</div>
            </div>
        </section>

        <!-- Catalog Section: The 8 Dimensions Grid -->
        <section id="catalog-section" class="space-y-6">
            <div class="border-l-4 border-emerald-600 pl-4">
                <h3 class="text-2xl font-bold text-gray-800">å…«å¤§é¢å‘ææ¡ˆç¸½è¦½</h3>
                <p class="text-gray-600 mt-1">é»æ“Šä¸‹æ–¹å¡ç‰‡å±•é–‹è©³ç´°çš„ A/B æ–¹æ¡ˆæ¯”è¼ƒã€‚</p>
            </div>

            <!-- Dynamic Grid Generated by JS -->
            <div id="categories-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Cards will be injected here -->
            </div>
        </section>

        <!-- Details Modal / Section (Hidden by default, shown on interaction) -->
        <section id="detail-view" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto backdrop-blur-sm">
            <div class="bg-white rounded-xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-y-auto relative animate-fade-in">
                <!-- Close Button -->
                <button onclick="closeDetail()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-700 p-2 text-2xl font-bold">&times;</button>
                
                <!-- Content Container -->
                <div id="detail-content" class="p-6 md:p-10">
                    <!-- Dynamic Detail Content -->
                </div>
            </div>
        </section>

        <!-- Voting Results Modal -->
        <section id="results-view" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 overflow-y-auto backdrop-blur-sm">
            <div class="bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto relative animate-fade-in">
                <button onclick="closeResults()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-700 p-2 text-2xl font-bold">&times;</button>
                <div class="p-8">
                    <h2 class="text-3xl font-bold text-emerald-800 mb-2 flex items-center gap-2">ğŸ† å³æ™‚ç¥¨é¸æ’è¡Œæ¦œ</h2>
                    <p class="text-gray-600 mb-6">ä»¥ä¸‹é¡¯ç¤ºç›®å‰å¾—ç¥¨æ•¸æœ€é«˜çš„ææ¡ˆï¼ˆåŒ…å«æ–¹æ¡ˆ A èˆ‡ Bï¼‰ã€‚</p>
                    
                    <div class="chart-container mb-6">
                        <canvas id="resultsChart"></canvas>
                    </div>

                    <div class="flex justify-end gap-4">
                        <button onclick="resetVotes()" class="text-red-500 hover:text-red-700 text-sm font-medium underline">âš ï¸ é‡ç½®æ‰€æœ‰ç¥¨æ•¸</button>
                        <button onclick="closeResults()" class="bg-gray-200 hover:bg-gray-300 text-gray-800 px-6 py-2 rounded-lg font-medium transition">é—œé–‰</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Toast Container -->
        <div id="toast-container"></div>

    </main>

    <footer class="bg-stone-100 border-t border-stone-200 mt-12 py-8 text-center text-gray-500 text-sm">
        <p>Â© 114å¹´åº¦å˜‰æ¦®æ°¸çºŒç”Ÿæ´»è¡Œå‹•ææ¡ˆç«¶è³½ - æ±ºç­–è¼”åŠ©ç³»çµ±</p>
        <p class="mt-2">Designed for Department of Family Medicine</p>
    </footer>

    <!-- JavaScript Logic -->
    <script>
        // --- Data: The 16 Proposals ---
        // Scores (effort, impact) are estimates based on the text analysis.
        // Effort: 1 (Easy) to 10 (Hard). Impact: 1 (Low) to 10 (High).
        const proposalsData = [
            {
                id: "01",
                name: "ç¯€èƒ½çœé›»",
                slogan: "çœé›»å‹•ä¸€å‹•",
                icon: "âš¡",
                desc: "é‡å°è¾¦å…¬å®¤ç„¡äººæ™‚æ®µçš„èƒ½æºç®¡ç†ã€‚",
                planA: {
                    type: "A",
                    title: "ç¶ è‰²å‡ºå‹¤ï¼Œé›¢å®¤æ–·é›»",
                    desc: "å»ºç«‹ã€Œæœ€å¾Œé›¢å®¤è€…æª¢æ ¸æ©Ÿåˆ¶ã€èˆ‡æ›ç‰Œåˆ¶åº¦ã€‚",
                    background: "ä¸­å¿ƒå¸¸å…¨å“¡å¤–å‡ºï¼Œè¾¦å…¬å®¤é•·æ™‚é–“ç„¡äººï¼Œæ˜“å¿˜è¨˜é—œé›»æºã€‚",
                    action: "è£½ä½œã€Œç¶ è‰²å‡ºå‹¤æ›ç‰Œã€ï¼Œé›¢å®¤æ™‚åŸ·è¡Œæ–·é›»ä¸‰æ­¥é©Ÿä¸¦ç¿»ç‰Œã€‚",
                    steps: ["ç›¤é»éå¿…è¦é›»æº", "è£½ä½œæ›ç‰Œ", "å¯¦æ–½æ–·é›»æª¢æŸ¥"],
                    resources: "è¡Œæ”¿äººåŠ›ã€å»¢ç´™æ¿è£½ä½œæ›ç‰Œ (ç„¡ç¶“è²»)",
                    effort: 3, impact: 7
                },
                planB: {
                    type: "B",
                    title: "é€±æœ«æ‹”æ’é ­ï¼Œå¾…æ©Ÿæ­¸é›¶",
                    desc: "é‡å°é€±æœ«é•·æ™‚æ®µçš„å¾…æ©Ÿé›»åŠ›é€²è¡Œåˆ‡æ–·ã€‚",
                    background: "é€±æœ«48å°æ™‚ç„¡äººï¼Œè¨­å‚™å¾…æ©Ÿé›»åŠ›ç´¯ç©é©šäººã€‚",
                    action: "é€±äº”ä¸‹ç­ã€Œæ‹”æ’é ­é‹å‹•ã€ï¼Œå€¼æ—¥ç”Ÿå·¡è¦–ã€‚",
                    steps: ["æ¨™ç¤ºå¯æ–·é›»æ’åº§", "é€±äº”å»£æ’­æé†’", "çµ±è¨ˆç¯€èƒ½æ•¸æ“š"],
                    resources: "ç¶ è‰²åœ“é»è²¼ç´™ (ç´„50å…ƒ)",
                    effort: 2, impact: 6
                }
            },
            {
                id: "02",
                name: "çœæ°´æœ‰é“",
                slogan: "æ»´æ°´ä¸æ¼æ‰",
                icon: "ğŸ’§",
                desc: "å„ªåŒ–æ´»å‹•å™¨ææ¸…æ´—èˆ‡å¾ªç’°æ°´åˆ©ç”¨ã€‚",
                planA: {
                    type: "A",
                    title: "æƒœæ°´å¦‚é‡‘ï¼Œæ•™å…·æ¸…æ´—SOP",
                    desc: "æ”¹è®Šæ¸…æ´—ç¿’æ…£ï¼Œç”±é•·æµæ°´æ”¹ç‚ºæµ¸æ³¡ã€‚",
                    background: "æ¸…æ´—å¤§é‡è¡›æ•™è»Ÿå¢Šå™¨ææ™‚ï¼Œå¸¸é–‹å¤§æ°´ç›´æ²–æµªè²»ã€‚",
                    action: "å»ºç«‹ã€Œæµ¸æ³¡â†’å°æ°´æ´—â†’å»¢æ°´æ²–åœ°ã€SOPã€‚",
                    steps: ["å¼µè²¼SOPåœ–ç¤º", "è³¼ç½®æµ¸æ³¡æ¡¶", "è½å¯¦åŸ·è¡Œ"],
                    resources: "å¤§å‹æ•´ç†ç®± (300-500å…ƒ)",
                    effort: 4, impact: 6
                },
                planB: {
                    type: "B",
                    title: "é™¤æº¼å›æ”¶ï¼Œæ¾†çŒç¶ æ„",
                    desc: "å›æ”¶é™¤æ¿•æ©Ÿèˆ‡å†·æ°£å†·å‡æ°´ã€‚",
                    background: "å˜‰ç¾©æ½®æ¿•ï¼Œé™¤æ¿•æ©Ÿæ°´ç®±æ°´ç›´æ¥å€’æ‰å¾ˆå¯æƒœã€‚",
                    action: "è¨­ç½®å›æ”¶æ¡¶ï¼Œç”¨æ–¼æ¾†èŠ±æˆ–æ‹–åœ°ã€‚",
                    steps: ["è¨­ç½®å›æ”¶æ¡¶", "æ¨™ç¤ºéé£²ç”¨", "å€¼æ—¥ç”Ÿæ¾†çŒ"],
                    resources: "æ°´æ¡¶ã€è²¼ç´™ (200å…ƒ)",
                    effort: 3, impact: 5
                }
            },
            {
                id: "03",
                name: "æ¸›å¡‘ç”Ÿæ´»",
                slogan: "ç’°ä¿æœ€æ™‚å°š",
                icon: "ğŸ›ï¸",
                desc: "æ¸›å°‘æ´»å‹•ç‰©è³‡èˆ‡æœƒè­°çš„ä¸€æ¬¡æ€§å¡‘è† ã€‚",
                planA: {
                    type: "A",
                    title: "ç„¡å¡‘ç¤¾å€è¡Œï¼Œè£å‚™è¢‹å¤§è®Šèº«",
                    desc: "å°å…¥æ¨¡çµ„åŒ–æ”¶ç´ç®±ï¼Œæ·˜æ±°ç´…ç™½å¡‘è† è¢‹ã€‚",
                    background: "å‡ºéšŠå¸¸äº‚å¡å¡‘è† è¢‹ï¼Œè£½é€ åƒåœ¾ä¸”ä¸å°ˆæ¥­ã€‚",
                    action: "ä½¿ç”¨æ¨™ç±¤åŒ–æ”¶ç´ç®±/å¸ƒè¢‹ï¼Œä¸€ç®±æäº†å°±èµ°ã€‚",
                    steps: ["ç›¤é»æ¡è³¼ç®±å­", "åˆ†é¡æ¨™ç¤º", "å‘æ°‘çœ¾å®£å°è‡ªå‚™è¢‹"],
                    resources: "æ•´ç†ç®±/ç’°ä¿è¢‹ (ç´„1000å…ƒ)",
                    effort: 5, impact: 8
                },
                planB: {
                    type: "B",
                    title: "æœƒè­°ä¸ç“¶è£ï¼ŒèŒ¶æ°´è‡ªå·±è£",
                    desc: "å…¨é¢åœæ­¢æä¾›ç“¶è£æ°´ã€‚",
                    background: "å¿—å·¥åŸ¹è¨“æˆ–æœƒè­°è£½é€ å¤§é‡å¯¶ç‰¹ç“¶åƒåœ¾ã€‚",
                    action: "åƒ…æä¾›å¤§æ¡¶èŒ¶æ°´ï¼Œé€šçŸ¥è«‹è‡ªå‚™æ¯å­ã€‚",
                    steps: ["ä¿®æ”¹æœƒè­°é€šçŸ¥", "è³¼ç½®èŒ¶æ¡¶", "ç¾å ´å®£å°"],
                    resources: "å¤§èŒ¶æ¡¶ (500å…ƒ)",
                    effort: 2, impact: 7
                }
            },
            {
                id: "04",
                name: "å»¢æ£„æ¸›é‡",
                slogan: "å›æ”¶ä¸éº»ç…©",
                icon: "ğŸ“±",
                desc: "æ¨å‹•ç„¡ç´™åŒ–è¡›æ•™èˆ‡å»¢ç´™å†åˆ©ç”¨ã€‚",
                planA: {
                    type: "A",
                    title: "é›²ç«¯è¡›æ•™ï¼Œæƒç¢¼å–ä»£å‚³å–®",
                    desc: "è¡›æ•™å–®å¼µæ•¸ä½åŒ–ï¼Œæ¸›å°‘å°åˆ·ã€‚",
                    background: "ç´™æœ¬å–®å¼µå¸¸è¢«éš¨æ‰‹ä¸Ÿæ£„ï¼Œä¸”åº«å­˜ç®¡ç†éº»ç…©ã€‚",
                    action: "è£½ä½œåœ–å¡ä¸Šå‚³é›²ç«¯ï¼Œç¾å ´æƒQR Codeã€‚",
                    steps: ["æ•™ææ•¸ä½åŒ–", "è£½ä½œQRç«‹ç‰Œ", "å¼•å°æƒæ"],
                    resources: "è­·è²ç«‹ç‰Œ (ç„¡ç¶“è²»)",
                    effort: 3, impact: 9
                },
                planB: {
                    type: "B",
                    title: "å»¢ç´™é‡ç”Ÿï¼Œç­†è¨˜å‚³æ‰¿",
                    desc: "å–®é¢å»¢ç´™è£½æˆä¾¿æ¢ç´™ã€‚",
                    background: "è¡Œæ”¿å–®é¢å»¢ç´™ç›´æ¥ç¢æ‰å¾ˆå¯æƒœã€‚",
                    action: "è£åˆ‡è£è¨‚æˆå…§éƒ¨ç”¨ä¾¿æ¢ç´™ã€‚",
                    steps: ["è¨­ç½®å›æ”¶ç›’", "è£åˆ‡è£è¨‚", "åˆ†ç™¼ä½¿ç”¨"],
                    resources: "ç¾æœ‰è£ç´™æ©Ÿ (ç„¡ç¶“è²»)",
                    effort: 4, impact: 4
                }
            },
            {
                id: "05",
                name: "ä½ç¢³é£²é£Ÿ",
                slogan: "åƒç•¶å­£æœ€å¥½",
                icon: "ğŸ¥¦",
                desc: "çµåˆåœ¨åœ°è¾²æ¥­èˆ‡æƒœé£Ÿè§€å¿µã€‚",
                planA: {
                    type: "A",
                    title: "å˜‰é„‰å‘³ãƒ»ç¶ é£ŸåŠ› (é¦–é¸æ¨è–¦)",
                    desc: "å°‡ã€Œåƒåœ¨åœ°ã€èå…¥ç¤¾å€é•·è€…ç‡Ÿé¤Šè¡›æ•™ã€‚",
                    background: "ç¼ºä¹çµåˆåœ¨åœ°é£Ÿæçš„ç³»çµ±æ€§æ¨å»£ï¼Œé•·è€…è§€å¿µæ¨¡ç³Šã€‚",
                    action: "æ•™å°é•·è€…åƒå˜‰ç¾©ç•¶å­£è¾²ç”¢ï¼Œå¥åº·åˆæ¸›ç¢³ã€‚",
                    steps: ["è£½ä½œç•¶å­£åœ–å¡", "ç¤¾å€çŸ­è¬›", "é•·è€…åˆ†äº«é¤ç›¤"],
                    resources: "ç¾æœ‰äººåŠ›ã€å°‘é‡å°åˆ·",
                    effort: 2, impact: 9
                },
                planB: {
                    type: "B",
                    title: "æƒœé£Ÿå…‰ç›¤ï¼Œå¥åº·ä¸ç•™é¤˜",
                    desc: "æ¨å‹•é©é‡é»é¤èˆ‡æ‰“åŒ…ã€‚",
                    background: "å…±é¤æˆ–ä¾¿ç•¶å¸¸æœ‰å‰©é£Ÿæµªè²»ã€‚",
                    action: "èª¿æŸ¥é£¯é‡éœ€æ±‚ï¼Œå®£å°è‡ªå‚™ç›’æ‰“åŒ…ã€‚",
                    steps: ["å¢åŠ é£¯é‡èª¿æŸ¥", "é¤å¾Œå®£å°", "çµ±è¨ˆå»šé¤˜"],
                    resources: "ç„¡",
                    effort: 3, impact: 5
                }
            },
            {
                id: "06",
                name: "ç¶ è‰²äº¤é€š",
                slogan: "å‡ºé–€å°‘æ’ç¢³",
                icon: "ğŸš—",
                desc: "å„ªåŒ–å‡ºå‹¤è·¯å¾‘èˆ‡æœƒè­°æ¨¡å¼ã€‚",
                planA: {
                    type: "A",
                    title: "å…±ä¹˜ç‰¹æ”»éšŠï¼Œè·¯å¾‘æœ€ä½³åŒ–",
                    desc: "å¼·åˆ¶åŸ·è¡Œæ»¿è¼‰å…±ä¹˜èˆ‡é †è·¯å·¡è¿´ã€‚",
                    background: "å¤šè»ŠåŒå¾€æˆ–åè¦†å¾€è¿”é€ æˆé«˜æ²¹è€—ã€‚",
                    action: "æ’ç­å¯©æŸ¥è·¯ç·šï¼Œå®‰æ’é€£çºŒå¼å·¡è¿´ã€‚",
                    steps: ["æ’ç­è·¯å¾‘å¯©æŸ¥", "é‡Œç¨‹ç™»è¨˜", "æª¢è¨æ²¹è€—"],
                    resources: "Google Maps, ä¸»ç®¡çµ±ç±Œ",
                    effort: 7, impact: 8
                },
                planB: {
                    type: "B",
                    title: "è¦–è¨Šé›¶è·é›¢ï¼Œæœƒè­°å…å¥”æ³¢",
                    desc: "è¡Œæ”¿æœƒè­°æ”¹æ¡ç·šä¸Šé€²è¡Œã€‚",
                    background: "å˜‰ç¾©-ç£æ©‹å¾€è¿”é–‹æœƒè€—æ™‚è€—èƒ½ã€‚",
                    action: "éå¿…è¦å¯¦é«”æœƒè­°æ”¹Teams/Lineã€‚",
                    steps: ["ç›¤é»æœƒè­°", "å»ºç«‹SOP", "çµ±è¨ˆæ¸›ç¢³é‡"],
                    resources: "ç¾æœ‰è¦–è¨Šè¨­å‚™",
                    effort: 2, impact: 8
                }
            },
            {
                id: "07",
                name: "ç¶ è‰²æ¡è³¼",
                slogan: "è²·å°æ›´æ°¸çºŒ",
                icon: "ğŸ›’",
                desc: "å„ªå…ˆæ¡è³¼ç’°ä¿æ¨™ç« ç”¢å“ã€‚",
                planA: {
                    type: "A",
                    title: "ç¶ è‰²å¿ƒæ„ï¼Œç¦®è¼•æƒ…æ„é‡",
                    desc: "æ´»å‹•è´ˆå“é¸ç”¨ç’°ä¿æ¨™ç« ç”¢å“ã€‚",
                    background: "è´ˆå“å¸¸å¿½ç•¥ç’°å¢ƒæˆæœ¬ã€‚",
                    action: "æ”¹è²·ç’°ä¿æ¨™ç« æ´—ç¢—ç²¾æˆ–åœ¨åœ°è¾²ç”¢ã€‚",
                    steps: ["ç¯©é¸ç¶ è‰²å•†å“", "èª¿æ•´æ¡è³¼", "å®£å°ç¶ è‰²æ¶ˆè²»"],
                    resources: "èª¿æ•´é ç®—åˆ†é…",
                    effort: 2, impact: 6
                },
                planB: {
                    type: "B",
                    title: "è£œå……ä»£æ›¿è³¼è²·ï¼Œå¤§æ¡¶æ›´åˆ’ç®—",
                    desc: "æ¡è³¼å¤§æ¡¶è£æ¸…æ½”åŠ‘è‡ªè¡Œåˆ†è£ã€‚",
                    background: "å°ç“¶è£è£½é€ å¤§é‡å¡‘è† ç½åƒåœ¾ã€‚",
                    action: "è²·5L/10Lè£œå……æ¶²å¡«å……èˆŠç“¶ã€‚",
                    steps: ["æ”¹è³¼å¤§æ¡¶è£", "å®šæœŸè£œå……", "è¨˜éŒ„æ¸›ç“¶é‡"],
                    resources: "æ¼æ–—",
                    effort: 3, impact: 5
                }
            },
            {
                id: "08",
                name: "å…¨å“¡åƒèˆ‡",
                slogan: "ç¶ æ´»ä¸€èµ·è¡Œ",
                icon: "ğŸ¤",
                desc: "å…§éƒ¨æ¿€å‹µèˆ‡åˆ†äº«æ©Ÿåˆ¶ã€‚",
                planA: {
                    type: "A",
                    title: "ç¤¾ç‡Ÿä¸­å¿ƒç¶ è‰²å­˜æ‘º",
                    desc: "é›†é»å¡æ¿€å‹µåŒä»è½å¯¦ç’°ä¿ã€‚",
                    background: "å¿™ç¢Œæ˜“å¿½ç•¥ç’°ä¿ç´°ç¯€ï¼Œç¼ºä¹èª˜å› ã€‚",
                    action: "è‡ªå¸¶æ¯ã€çˆ¬æ¢¯å¯é›†é»ï¼Œæ›ä¸‹åˆèŒ¶ã€‚",
                    steps: ["è£½ä½œé›†é»å¡", "æ¦®è­½äº’èª", "å­£çµç®—çå‹µ"],
                    resources: "å°çå‹µå“ (ä¸»ç®¡è´ŠåŠ©)",
                    effort: 5, impact: 7
                },
                planB: {
                    type: "B",
                    title: "èˆŠæ„›æ–°æ­¡ï¼Œå¥½æ›¸äº¤æ›",
                    desc: "è¨­ç½®è¾¦å…¬å®¤æ¼‚æ›¸ç«™ã€‚",
                    background: "å®¶ä¸­é–’ç½®æ›¸ç±å¯å¾ªç’°åˆ©ç”¨ã€‚",
                    action: "è¨­ç½®æ¼‚æ›¸ç®±ï¼Œè‡ªç”±å€Ÿé–±äº¤æ›ã€‚",
                    steps: ["æ•´ç†æ›¸æ«ƒ", "è™Ÿå¬ææ›¸", "å®šæœŸç¶­è­·"],
                    resources: "ç©ºæ›¸æ«ƒ",
                    effort: 2, impact: 4
                }
            }
        ];

        // --- Voting Logic (LocalStorage) ---
        // Format: { '01-A': 5, '02-B': 3, ... }
        let voteCounts = JSON.parse(localStorage.getItem('voteCounts')) || {};

        function castVote(id, type, name, title) {
            const key = `${id}-${type}`;
            voteCounts[key] = (voteCounts[key] || 0) + 1;
            localStorage.setItem('voteCounts', JSON.stringify(voteCounts));
            
            // UI Feedback
            showToast(`å·²æŠ•çµ¦ #${id} æ–¹æ¡ˆ ${type}`);
            
            // Update button text immediately if visible
            const btn = document.getElementById(`btn-vote-${key}`);
            if (btn) {
                const countSpan = document.getElementById(`count-${key}`);
                if (countSpan) countSpan.innerText = voteCounts[key];
            }
        }

        function getVoteCount(id, type) {
            return voteCounts[`${id}-${type}`] || 0;
        }

        function resetVotes() {
            if(confirm("ç¢ºå®šè¦æ¸…ç©ºæ‰€æœ‰ç¥¨æ•¸å—ï¼Ÿæ­¤å‹•ä½œç„¡æ³•å¾©åŸã€‚")) {
                voteCounts = {};
                localStorage.removeItem('voteCounts');
                closeResults();
                showToast("ç¥¨æ•¸å·²é‡ç½®");
            }
        }

        function showToast(message) {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.innerText = message;
            container.appendChild(toast);
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // --- Chart.js Initialization ---
        function initChart() {
            const ctx = document.getElementById('strategyChart').getContext('2d');
            
            // Prepare data for Scatter Plot
            const dataPoints = [];
            proposalsData.forEach(cat => {
                // Plan A Point
                dataPoints.push({
                    x: cat.planA.effort,
                    y: cat.planA.impact,
                    r: 12, // bubble radius
                    category: cat.name,
                    plan: 'A',
                    title: cat.planA.title,
                    id: cat.id
                });
                // Plan B Point
                dataPoints.push({
                    x: cat.planB.effort,
                    y: cat.planB.impact,
                    r: 10, // slightly smaller
                    category: cat.name,
                    plan: 'B',
                    title: cat.planB.title,
                    id: cat.id
                });
            });

            new Chart(ctx, {
                type: 'bubble',
                data: {
                    datasets: [{
                        label: 'æ–¹æ¡ˆ A (åˆ¶åº¦)',
                        data: dataPoints.filter(d => d.plan === 'A'),
                        backgroundColor: 'rgba(16, 185, 129, 0.7)', // Emerald 500
                        borderColor: 'rgba(6, 95, 70, 1)',
                        borderWidth: 1
                    },
                    {
                        label: 'æ–¹æ¡ˆ B (è¡Œå‹•)',
                        data: dataPoints.filter(d => d.plan === 'B'),
                        backgroundColor: 'rgba(59, 130, 246, 0.7)', // Blue 500
                        borderColor: 'rgba(30, 64, 175, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: { display: true, text: 'åŸ·è¡Œé›£æ˜“åº¦ (è¶Šå³è¶Šé›£)' },
                            min: 0, max: 10,
                            grid: { color: '#e5e7eb' }
                        },
                        y: {
                            title: { display: true, text: 'é æœŸå½±éŸ¿åŠ› (è¶Šé«˜è¶Šå¥½)' },
                            min: 0, max: 10,
                            grid: { color: '#e5e7eb' }
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const point = context.raw;
                                    return `${point.category} [${point.plan}]: ${point.title}`;
                                }
                            }
                        },
                        legend: { position: 'bottom' }
                    },
                    onClick: (e, activeEls) => {
                        if (activeEls.length > 0) {
                            const point = activeEls[0].element.$context.raw;
                            openDetail(point.id);
                        }
                    }
                }
            });
        }

        // --- Results Chart Logic ---
        let resultsChartInstance = null;

        function openResults() {
            document.getElementById('results-view').classList.remove('hidden');
            renderResultsChart();
        }

        function closeResults() {
            document.getElementById('results-view').classList.add('hidden');
        }

        function renderResultsChart() {
            const ctx = document.getElementById('resultsChart').getContext('2d');
            
            // Prepare Data: Flatten and Sort
            let rankedData = [];
            proposalsData.forEach(cat => {
                ['A', 'B'].forEach(type => {
                    const key = `${cat.id}-${type}`;
                    const count = voteCounts[key] || 0;
                    const plan = type === 'A' ? cat.planA : cat.planB;
                    // Only show items with votes, or top 5 if empty? Show all > 0 or top 10.
                    // Let's show all items that have at least 1 vote. If none, show placeholder.
                    if (count >= 0) { 
                         rankedData.push({
                            label: `${cat.id}-${type} ${plan.title.substring(0, 10)}...`,
                            count: count,
                            color: type === 'A' ? 'rgba(16, 185, 129, 0.8)' : 'rgba(59, 130, 246, 0.8)',
                            fullTitle: plan.title
                        });
                    }
                });
            });

            // Sort by count desc
            rankedData.sort((a, b) => b.count - a.count);
            // Take top 10
            const topData = rankedData.slice(0, 10);

            const labels = topData.map(d => d.label);
            const data = topData.map(d => d.count);
            const colors = topData.map(d => d.color);

            if (resultsChartInstance) {
                resultsChartInstance.destroy();
            }

            resultsChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'å¾—ç¥¨æ•¸',
                        data: data,
                        backgroundColor: colors,
                        borderRadius: 4
                    }]
                },
                options: {
                    indexAxis: 'y', // Horizontal bar chart
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            beginAtZero: true,
                            ticks: { stepSize: 1 }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                title: (items) => {
                                    const idx = items[0].dataIndex;
                                    return topData[idx].fullTitle;
                                }
                            }
                        }
                    }
                }
            });
        }


        // --- DOM Rendering ---
        function renderCategories() {
            const grid = document.getElementById('categories-grid');
            grid.innerHTML = proposalsData.map(cat => `
                <div onclick="openDetail('${cat.id}')" class="bg-white rounded-xl shadow-sm border border-stone-100 p-6 cursor-pointer card-hover group transition-all duration-200">
                    <div class="flex items-center justify-between mb-4">
                        <span class="text-4xl bg-stone-50 p-3 rounded-full">${cat.icon}</span>
                        <span class="text-xs font-bold text-gray-400">#${cat.id}</span>
                    </div>
                    <h4 class="text-xl font-bold text-gray-800 group-hover:text-emerald-700 transition">${cat.name}</h4>
                    <p class="text-sm text-emerald-600 font-medium mb-2">${cat.slogan}</p>
                    <p class="text-gray-500 text-sm line-clamp-2">${cat.desc}</p>
                    <div class="mt-4 flex gap-2">
                        <span class="text-xs bg-emerald-50 text-emerald-700 px-2 py-1 rounded border border-emerald-100">æ–¹æ¡ˆ A</span>
                        <span class="text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded border border-blue-100">æ–¹æ¡ˆ B</span>
                    </div>
                </div>
            `).join('');
        }

        // --- Modal Logic ---
        function openDetail(id) {
            const cat = proposalsData.find(c => c.id === id);
            if (!cat) return;

            const contentDiv = document.getElementById('detail-content');
            contentDiv.innerHTML = `
                <div class="mb-8 border-b pb-4">
                    <div class="flex items-center gap-3 mb-2">
                        <span class="text-4xl">${cat.icon}</span>
                        <h2 class="text-3xl font-bold text-emerald-900">${cat.id} ${cat.name}</h2>
                    </div>
                    <p class="text-xl text-emerald-600 font-medium">${cat.slogan}</p>
                </div>

                <!-- Tabs -->
                <div class="flex border-b border-gray-200 mb-6">
                    <button onclick="switchTab('planA')" id="tab-btn-A" class="active-tab py-2 px-6 text-lg transition-colors">æ–¹æ¡ˆ A (åˆ¶åº¦é¢)</button>
                    <button onclick="switchTab('planB')" id="tab-btn-B" class="inactive-tab py-2 px-6 text-lg transition-colors">æ–¹æ¡ˆ B (è¡Œå‹•é¢)</button>
                </div>

                <!-- Plan A Content -->
                <div id="content-planA" class="fade-in">
                    ${renderPlanHTML(cat.id, cat.planA, 'emerald')}
                </div>
                
                <!-- Plan B Content (Hidden) -->
                <div id="content-planB" class="hidden fade-in">
                    ${renderPlanHTML(cat.id, cat.planB, 'blue')}
                </div>
            `;

            document.getElementById('detail-view').classList.remove('hidden');
            // Reset tab state
            switchTab('planA'); 
        }

        function renderPlanHTML(catId, plan, color) {
            const bgClass = color === 'emerald' ? 'bg-emerald-50' : 'bg-blue-50';
            const textClass = color === 'emerald' ? 'text-emerald-800' : 'text-blue-800';
            const borderClass = color === 'emerald' ? 'border-emerald-200' : 'border-blue-200';
            const btnBgClass = color === 'emerald' ? 'bg-emerald-600 hover:bg-emerald-700' : 'bg-blue-600 hover:bg-blue-700';
            const currentVotes = getVoteCount(catId, plan.type);

            return `
                <div class="${bgClass} border ${borderClass} rounded-lg p-6 mb-6 relative">
                    <!-- Voting Button Block -->
                    <div class="md:absolute md:top-6 md:right-6 mb-4 md:mb-0">
                        <button id="btn-vote-${catId}-${plan.type}" 
                                onclick="castVote('${catId}', '${plan.type}', '${proposalsData.find(c=>c.id===catId).name}', '${plan.title}')"
                                class="${btnBgClass} text-white px-6 py-3 rounded-full shadow-lg flex items-center gap-3 transition transform hover:scale-105 active:scale-95 w-full md:w-auto justify-center">
                            <span class="text-xl">ğŸ—³ï¸</span>
                            <div class="text-left leading-tight">
                                <span class="block font-bold text-sm">æŠ•æˆ‘ä¸€ç¥¨</span>
                                <span class="block text-xs opacity-90">ç›®å‰ç¥¨æ•¸: <span id="count-${catId}-${plan.type}" class="font-bold text-white text-lg">${currentVotes}</span></span>
                            </div>
                        </button>
                    </div>

                    <h3 class="text-2xl font-bold ${textClass} mb-2 pr-0 md:pr-40">${plan.title}</h3>
                    <p class="text-gray-700 font-medium mb-4 pr-0 md:pr-40">${plan.desc}</p>
                    
                    <div class="grid md:grid-cols-2 gap-6 mt-6">
                        <div>
                            <h4 class="font-bold text-gray-800 mb-2">ææ¡ˆèƒŒæ™¯</h4>
                            <p class="text-gray-600 text-sm mb-4">${plan.background}</p>
                            
                            <h4 class="font-bold text-gray-800 mb-2">å…·é«”åšæ³•</h4>
                            <p class="text-gray-600 text-sm mb-4">${plan.action}</p>
                        </div>
                        <div>
                             <h4 class="font-bold text-gray-800 mb-2">åŸ·è¡Œæ­¥é©Ÿ</h4>
                             <ul class="list-disc list-inside text-gray-600 text-sm mb-4 space-y-1">
                                ${plan.steps.map(s => `<li>${s}</li>`).join('')}
                             </ul>

                             <h4 class="font-bold text-gray-800 mb-2">éœ€è¦è³‡æº</h4>
                             <p class="text-gray-600 text-sm bg-white p-2 rounded border border-gray-100 shadow-sm">${plan.resources}</p>
                        </div>
                    </div>
                </div>
                
                <!-- Analysis Tags -->
                <div class="flex gap-4 items-center text-sm text-gray-500">
                    <div class="flex flex-col">
                        <span class="text-xs uppercase tracking-wide">é›£æ˜“åº¦</span>
                        <div class="w-24 h-2 bg-gray-200 rounded-full mt-1 overflow-hidden">
                            <div class="h-full ${color === 'emerald' ? 'bg-emerald-500' : 'bg-blue-500'}" style="width: ${plan.effort * 10}%"></div>
                        </div>
                    </div>
                    <div class="flex flex-col">
                        <span class="text-xs uppercase tracking-wide">å½±éŸ¿åŠ›</span>
                        <div class="w-24 h-2 bg-gray-200 rounded-full mt-1 overflow-hidden">
                            <div class="h-full bg-yellow-400" style="width: ${plan.impact * 10}%"></div>
                        </div>
                    </div>
                </div>
            `;
        }

        function switchTab(plan) {
            const btnA = document.getElementById('tab-btn-A');
            const btnB = document.getElementById('tab-btn-B');
            const contentA = document.getElementById('content-planA');
            const contentB = document.getElementById('content-planB');

            if (plan === 'planA') {
                btnA.classList.add('active-tab', 'text-emerald-800');
                btnA.classList.remove('inactive-tab', 'text-gray-500');
                btnB.classList.add('inactive-tab', 'text-gray-500');
                btnB.classList.remove('active-tab', 'text-blue-800', 'border-blue-800');
                btnB.style.borderBottom = 'none';
                btnA.style.borderBottom = '2px solid #065f46'; // emerald-800

                contentA.classList.remove('hidden');
                contentB.classList.add('hidden');
            } else {
                btnB.classList.add('active-tab', 'text-blue-800');
                btnB.classList.remove('inactive-tab', 'text-gray-500');
                btnA.classList.add('inactive-tab', 'text-gray-500');
                btnA.classList.remove('active-tab', 'text-emerald-800', 'border-emerald-800');
                btnA.style.borderBottom = 'none';
                btnB.style.borderBottom = '2px solid #1e40af'; // blue-800

                contentB.classList.remove('hidden');
                contentA.classList.add('hidden');
            }
        }

        function closeDetail() {
            document.getElementById('detail-view').classList.add('hidden');
        }
        
        // Close modal on outside click
        document.getElementById('detail-view').addEventListener('click', function(e) {
            if (e.target === this) closeDetail();
        });

        function scrollToSection(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        }

        // --- Init ---
        window.onload = function() {
            renderCategories();
            initChart();
        };

    </script>
</body>
</html>
